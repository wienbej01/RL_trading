project: rl-intraday
seed: 42

data:
  instrument: SPY
  minute_file: data/raw/spy_1min.parquet        # Polygon data for SPY
  vix_file: data/external/vix.csv
  cvol_file: data/external/cvol.csv
  macro_flags_file: data/external/macro_flags.csv
  session:
    tz: America/New_York
    rth_start: "09:30"
    rth_end: "16:00"
  lookback_bars: 120            # ~2 hours context for LSTM
  resample: "1min"
  drop_na_policy: "forward_fill"
  provider: auto  # Primary data provider: 'polygon', 'databento', or 'auto'
  fallback_provider: databento  # Fallback data provider for reliability
  polygon_timeout: 30  # Request timeout in seconds
  polygon:
    api_key: ${POLYGON_API_KEY}
    base_url: https://api.polygon.io
    api_version: v2
    rate_limit:
      calls_per_minute: 5
      burst_limit: 10
    retry:
      attempts: 3
      backoff_factor: 2.0
    cache:
      directory: data/cache/polygon
      format: parquet
      partition_format: "year=%Y/month=%m/day=%d"
    validation:
      enabled: true
      fill_gaps: forward_fill
      outlier_detection: true
  databento:
    api_key: ${DATABENTO_API_KEY}

features:
  data_source: 'polygon'
  technical:
    calculate_returns: true
    calculate_log_returns: true
    sma_windows: [5, 10, 20, 50]
    ema_windows: [5, 10, 20, 50]
    calculate_atr: true
    atr_window: 14
    calculate_rsi: true
    rsi_window: 14
    calculate_macd: true
    calculate_bollinger_bands: true
    bollinger_window: 20
    calculate_stochastic: true
    calculate_williams_r: true
  microstructure:
    calculate_spread: true
    calculate_microprice: true
    calculate_queue_imbalance: true
    calculate_vwap: true
    calculate_twap: true
    calculate_price_impact: true
  time:
    extract_time_of_day: true
    extract_day_of_week: true
    extract_session_features: true
  polygon:
    features:
      use_vwap_column: true
    quality_checks:
      enabled: true

regime:
  vix: true
  cvol: true
  macro_flags: true

execution:
  tick_value: 0.01            # SPY tick $0.01 (1 cent per share)
  point_value: 1.0            # $ per point for SPY ETF
  spread_ticks: 1             # baseline spread consumption
  impact_bps: 0.5             # temporary impact per 1% ADV (toy)
  commission_per_contract: 0.0035  # Typical ETF commission per share

risk:
  risk_per_trade_frac: 0.02   # 2%
  stop_r_multiple: 1.0
  tp_r_multiple: 1.5
  max_daily_loss_r: 3.0       # kill-switch

env:
  step_seconds: 60
  reward:
    kind: "dsr"               # differential sharpe
    dd_penalty: 0.1
    eod_inventory_penalty: 0.5

train:
  algo: "ppo_lstm"
  total_steps: 100000
  batch_size: 2048
  learning_rate: 1.0e-4
  n_envs: 1
  gamma: 0.99
  gae_lambda: 0.95
  clip_range: 0.2
  vf_coef: 0.5
  ent_coef: 0.0
  n_steps: 2048
  policy_kwargs:
    lstm_hidden_size: 128
    net_arch_pi: [128, 64]
    net_arch_vf: [128, 64]

walkforward:
  train_days: 30
  test_days: 10
  embargo_minutes: 60

logging:
  level: INFO
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: logs/trading_system.log
  max_bytes: 10485760  # 10MB
  backup_count: 5

monitoring:
  enable_prometheus: false
  prometheus_port: 8000
  metrics_interval: 60  # seconds
  alert_file: alerts/alerts.yaml